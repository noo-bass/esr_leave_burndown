!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=d3},function(t,e,n){"use strict";n.r(e);var r=n(0);function a(t){return new Promise((function(e,n){e(t.events.map(t=>r.timeParse("%Y-%m-%d")(t.date)))}))}var u=r.timeParse("%Y-%m-%d");function o(t){return new Promise((function(e,n){var r=t.map(t=>t.date),a=t.columns.slice(2).map((function(e){var n=t.filter((function(t){return""!==t[e]})).map((function(t){var n=+t[e]/7.5;return{date:t.date,days:n}}));return{id:e,values:n}}));e([t,r,a])}))}var l=r.select("svg"),i=20,s=20,d=30,c=50,f=+l.attr("width")-c-s,p=+l.attr("height")-i-d,v=l.append("g").attr("transform","translate("+c+","+i+")"),m=r.scaleTime().rangeRound([0,f]),y=r.scaleLinear().rangeRound([p,0]),g=r.scaleOrdinal(r.schemeCategory10),h=r.line().x((function(t){return m(t.date)})).y((function(t){return y(t.days)}));function x(t,e){var n={};for(let u of t){var r=0,a=0;e.forEach((function(t){n[t]||(n[t]=0);let e=u.values.find((function(e){return e.date==t}));void 0===e?r=a:(r=e.days,a=r),n[t]+=r}))}let u=e[0];for(let e of t){let t=e.values.map((function(t){return t.date})),n=new Date(Math.max.apply(null,t));n>u&&(u=n)}var o=[];for(let e in n){var l=n[e];new Date(e)<u&&o.push({date:new Date(e),days:l/t.length})}return o}function w(t,e){var n=t.getDay();return n>0&&n<6&&!e.includes(t)}function b(t,e,n,a,u,o){t.append("path").datum(function(t,e,n){for(var r=5,a=[],u=t.length;u--&&!(r>n);){var o=t[u];a.push({date:o,days:r}),w(o,e)&&++r}return a}(e,n,a)).attr("class","lost").attr("d",function(t,e){return r.area().x(e=>t(e.date)).y0(0).y1(t=>e(t.days))}(u,o))}var D=function(t){return"steelblue"};function P(t,e,n,a,u){t.append("path").datum(function(t,e){var n=27,r=[];return t.forEach((function(t){if(n<0)return!1;r.push({date:t,days:n}),w(t,e)&&--n})),r}(e,n)).attr("class","unavailable").attr("d",function(t,e){return r.area().x(e=>t(e.date)).y0(e(0)).y1(t=>e(t.days))}(a,u))}Promise.all([r.tsv("leave.csv",(function(t){return t.date=u(t.date),t})).then(o),r.json("https://www.gov.uk/bank-holidays/england-and-wales.json").then(a)]).then(([[t,e,n],a])=>{var u=r.max(n,(function(t){return r.max(t.values,t=>t.days)}));m.domain(r.extent(t,t=>t.date)),y.domain([0,u]),g.domain(n.map((function(t){return t.id}))),P(v,e,a,m,y),b(v,e,a,u,m,y),drawBounds(v,e,a,h),function(t,e,n){t.append("line").attr("class","today").attr("x1",()=>e(new Date)).attr("x2",()=>e(new Date)).attr("y1",()=>n(0)).attr("y2",0)}(v,m,y),function(t,e,n,r){var a=x(e,n);t.append("path").datum(a).attr("class","line planned trend bg").attr("d",(function(t){return r(t.filter((function(t){return t.date>new Date})))})),t.append("path").datum(a).attr("class","line planned trend").attr("d",(function(t){return r(t.filter((function(t){return t.date>new Date})))}))}(v,n,e,h),function(t,e,n,r,a,u){var o=e.selectAll(".person").data(n).enter().append("g").attr("class",(function(t,e){return"person esr"+e})).attr("title",t=>t.id);o.append("path").attr("class","line").attr("d",(function(t){return r(t.values.filter((function(t){return t.date<=new Date})))})).style("stroke",t=>D(t.id)),o.append("path").attr("class","line planned").attr("d",(function(t){return r(t.values.filter((function(t){return t.date>new Date})))})).style("stroke",t=>D(t.id)),o.append("path").attr("class","target").attr("d",t=>r(t.values)).style("stroke",t=>D(t.id)).on("mouseover",(function(e,n){return function(t,e,n){t.selectAll("g.person").classed("unselected",!0),t.selectAll("g.person.esr"+n).classed("unselected",!1),t.selectAll("g.person.esr"+n).classed("selected",!0)}(t,0,n)})).on("mouseout",(function(e,n){return function(t,e,n){t.selectAll("g.person").classed("unselected",!1),t.selectAll("g.person.esr"+n).classed("selected",!1)}(t,0,n)})),o.append("text").datum((function(t){return{id:t.id,value:t.values[t.values.filter((function(t){return t.date<=new Date})).length-1]}})).attr("class","bg").attr("transform",(function(t){return"translate("+a(t.value.date)+","+u(t.value.days)+")"})).attr("x",5).attr("dy",-5).text((function(t){return t.id})),o.append("text").datum((function(t){return{id:t.id,value:t.values[t.values.filter((function(t){return t.date<=new Date})).length-1]}})).attr("transform",(function(t){return"translate("+a(t.value.date)+","+u(t.value.days)+")"})).attr("x",5).attr("dy",-5).text((function(t){return t.id}))}(l,v,n,h,m,y),function(t,e,n,r){var a=x(e,n);t.append("path").datum(a).attr("class","line trend bg").attr("d",(function(t){return r(t.filter((function(t){return t.date<=new Date})))})),t.append("path").datum(a).attr("class","line trend").attr("d",(function(t){return r(t.filter((function(t){return t.date<=new Date})))}))}(v,n,e,h),function(t,e,n,a){t.append("g").attr("transform","translate(0,"+e+")").call(r.axisBottom(n).tickFormat((function(t){return r.timeYear(t)<t?r.timeFormat("%B")(t):r.timeFormat("%Y")(t)}))),t.append("g").call(r.axisLeft(a)).append("text").attr("fill","#000").attr("transform","rotate(-90)").attr("y",6).attr("dy","-3.71em").attr("text-anchor","end").text("Leave (Days)")}(v,p,m,y)}).catch(t=>{console.log(`error: ${t}`)})}]);